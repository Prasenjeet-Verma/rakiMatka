<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link rel="stylesheet" href="/css/adminDashbord.css">

     <style>
        /* Custom scrollbar for the table wrapper */
        .custom-scrollbar::-webkit-scrollbar { height: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #ccc; border-radius: 10px; }
     </style>

  </head>
  <body class="flex min-h-screen">
    <aside
      id="sidebar"
      class="sidebar border-r border-gray-200 fixed inset-y-0 left-0 z-50 lg:relative lg:translate-x-0 transform -translate-x-full lg:block"
    >
      <div class="p-4">
        <div class="relative mb-4">
          <input
            type="text"
            placeholder="Search"
            class="w-full bg-white border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"
          />
          <button
            class="absolute right-0 top-0 bottom-0 px-3 bg-neutral-800 text-white rounded-r"
          >
            <i class="fas fa-search"></i>
          </button>
        </div>
      </div>

       <!-- ============================= Nav is here ============================ -->

     <%- include('../partials/adminNav') %>
    </aside>

    <main class="flex-1 flex flex-col min-w-0 overflow-hidden">

      <!-- ============================= Header is here ============================ -->
<%- include('../partials/adminHeader') %>
      
      <header
        class="bg-white h-14 flex items-center justify-between px-4 border-b border-gray-200"
      >
      </header>    <!-- header overflow done -->

     <!-- ==================================== Body Start Here ========================================= -->

<main class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-4xl bg-white border border-gray-200 rounded-sm shadow-sm">
        
        <div class="px-4 py-3 border-b border-gray-200 bg-white">
            <h2 class="text-gray-700 text-lg font-medium">Change Password</h2>
        </div>

<form id="change-password-form" class="p-6 space-y-5">
  <!-- Message container -->
  <div id="message" class="text-sm font-medium"></div>

  <div>
    <label for="old-password" class="block text-sm font-bold text-gray-800 mb-1">
      Old Password:
    </label>
    <input type="password" id="old-password" name="oldPassword" required 
           class="w-full px-3 py-2 border border-gray-300 rounded-sm focus:outline-none focus:ring-1 focus:ring-blue-500 transition-all">
  </div>

  <div>
    <label for="new-password" class="block text-sm font-bold text-gray-800 mb-1">
      New Password:
    </label>
    <input type="password" id="new-password" name="newPassword" required
           class="w-full px-3 py-2 border border-gray-300 rounded-sm focus:outline-none focus:ring-1 focus:ring-blue-500 transition-all">
  </div>

  <div>
    <label for="confirm-password" class="block text-sm font-bold text-gray-800 mb-1">
      Confirm Password:
    </label>
    <input type="password" id="confirm-password" name="confirmPassword" required
           class="w-full px-3 py-2 border border-gray-300 rounded-sm focus:outline-none focus:ring-1 focus:ring-blue-500 transition-all">
  </div>

  <div class="pt-2">
    <button type="submit" 
            class="bg-[#eab308] hover:bg-[#ca8a04] text-white font-medium py-2 px-4 rounded-md transition-colors duration-200">
      Update Password
    </button>
  </div>
</form>
    </div>

  </main>

      <!-- ==================================== Body End Here ========================================= -->
  </main>
    <script src="/js/sidebar.js"></script>
 <script>
const form = document.getElementById("change-password-form");
const messageDiv = document.getElementById("message");

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const oldPassword = document.getElementById("old-password").value;
  const newPassword = document.getElementById("new-password").value;
  const confirmPassword = document.getElementById("confirm-password").value;

  try {
    const res = await fetch("/admin/change-password", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ oldPassword, newPassword, confirmPassword }),
    });

    const data = await res.json();

    if (data.error) {
      messageDiv.textContent = data.error;
      messageDiv.className = "text-red-600 text-sm font-medium";
    } else if (data.success) {
      messageDiv.textContent = data.success;
      messageDiv.className = "text-green-600 text-sm font-medium";
      form.reset();
    }
  } catch (err) {
    messageDiv.textContent = "Server error. Try again later.";
    messageDiv.className = "text-red-600 text-sm font-medium";
    console.error(err);
  }
});
</script>
    <!-- <script src="js/adminResult.js"></script>
    <script src="js/adminResultDOM.js"></script> -->
  </body>
</html>
